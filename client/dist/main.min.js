!function(e){function t(r){if(n[r])return n[r].exports;var o=n[r]={exports:{},id:r,loaded:!1};return e[r].call(o.exports,o,o.exports,t),o.loaded=!0,o.exports}var n={};return t.m=e,t.c=n,t.p="",t(0)}([function(e,t,n){e.exports=n(1)},function(e,t,n){var r;r=angular.module("florentindubois.kraken",["ngAria","ngAnimate","ngMaterial","ngMessages","ngRoute","ngSanitize","pascalprecht.translate","md.data.table"]),r.config(["$routeProvider",function(e){var t,n,r;r=[{path:"/fs",controller:"fs",templateUrl:"views/fs.jade"},{path:"/fs/:signet",controller:"fs",templateUrl:"views/fs.jade"},{path:"/manage-account",controller:"manageAccount",templateUrl:"views/manage-account.jade"}];for(t in r)n=r[t],e.when(n.path,{controller:"kraken."+n.controller,templateUrl:n.templateUrl});e.otherwise("/fs")}]),r.config(["$mdThemingProvider",function(e){e.theme("default").primaryPalette("indigo",{"default":"800"}).accentPalette("pink").warnPalette("red")}]),r.config(["$translateProvider",function(e){var t,r,o,u;for(o=["en"],t=0,u=o.length;t<u;t++)r=o[t],e.translations(r,n(2)("./"+r+".lang.json"));e.useSanitizeValueStrategy(null),e.preferredLanguage("en"),e.fallbackLanguage("en")}]),r.controller("kraken.fs",["$scope","$fs","$translate","$logger","$mdDialog","$routeParams","$signets","$compress","$mdSidenav","$window","$audio","$video",function(e,t,n,r,o,u,i,s,a,l,c,f){e.selecteds=[],e.files=[],e.load=!0,e.path="/",e.share={},e.realpath=t.realpath,e.list=function(n){return e.load=!0,e.path=t.realpath(n),t.list(n,function(t,n){if(e.load=!1,null==t)return e.files=n})},e.open=function(t){return e.list(e.path+"/"+t)},e.rename=function(u,i){return n("fs.renameDialog.title").then(function(s){return n("fs.renameDialog.text").then(function(a){return n("fs.renameDialog.placeholder").then(function(l){return n("fs.renameDialog.ok").then(function(c){return n("fs.renameDialog.cancel").then(function(f){var m;return m=o.prompt(),m.title(s).textContent(a).placeholder(l).ariaLabel(l).targetEvent(i).ok(c).cancel(f),o.show(m).then(function(o){return e.load=!0,t.rename(e.path+"/"+u,e.path+"/"+o,function(t,o){return null!=t?e.list(e.path):o.renamed===!0?n("fs.renameDialog.success").then(function(t){return e.list(e.path),r.info(t)}):void 0})},function(){})})})})})})},e.remove=function(o){return t.remove(e.path+"/"+o,function(t,u){if(null==t)return n("fs.remove").then(function(t){return e.list(e.path),r.info(t+" : "+o)})})},e.removeSelecteds=function(){var t,n,r,o,u;for(o=e.selecteds,u=[],n=0,r=o.length;n<r;n++)t=o[n],u.push(e.remove(t.name));return u},e.listFromSignet=function(t){return e.load=!0,i.getOne(t,function(t,n){return e.list(n.path)})},e.compress=function(t){return s.zip(e.path+"/"+t,function(t,o){if(null==t&&o.compressed===!0)return n("fs.compress.success").then(function(t){return r.info(t),e.list(e.path)})})},e.uncompress=function(t){return s.unzip(e.path+"/"+t,function(t,o){if(null==t&&o.uncompressed===!0)return n("fs.uncompress.success").then(function(t){return r.info(t),e.list(e.path)})})},e.bookmark=function(t){return i.create(e.path+"/"+t,function(e,t){if(!e&&t.created===!0)return n("fs.bookmark.success").then(function(e){return r.info(e)})})},e.isArchive=function(e){return/\.zip$/gi.test(e)},e.isAudioPlayable=function(n){return c.isPlayable(t.realpath(e.path+"/"+n))},e.isPlayable=function(n){return c.isPlayable(t.realpath(e.path+"/"+n))||f.isPlayable(t.realpath(e.path+"/"+n))},e.play=function(n){return c.isPlayable(t.realpath(e.path+"/"+n))?c.play(e.path,n):f.isPlayable(t.realpath(e.path+"/"+n))?f.play(e.path,n):void 0},e.queue=function(t){return c.queue(e.path,t)},e.queueSelecteds=function(){var t,n,r,o,u;for(o=e.selecteds,u=[],n=0,r=o.length;n<r;n++)t=o[n],c.isPlayable(t.name)?u.push(e.queue(t.name)):u.push(void 0);return u},e.playQueue=function(){return c.playQueue()},null!=u.signet?e.listFromSignet(u.signet):e.list(e.path)}]),r.controller("kraken.login",["$scope","$user","$logger","$translate","$window","$timeout",function(e,t,n,r,o,u){e.login={},e.submit=function(){return t.login(e.login.username,e.login.password,function(e,t){if(null==e)return t.connected?r("login.success").then(function(e){return n.info(e),u(function(){return o.location.assign(t.redirect)},1e3)}):r("login.wrong").then(function(e){return n.error(e)})}),!1}}]),r.controller("kraken.manageAccount",["$scope","$user","$translate","$logger",function(e,t,n,r){e.users=[],e.user={},e.getUsers=function(){return t.getAll(function(t,n){if(null==t)return e.users=n,e.updateUser.$setPristine(),e.updateUser.$setUntouched(),e.user={}})},e.select=function(t){return e.user=e.users[t]},e.add=function(){return e.users.push({}),e.select(e.users.length-1)},e.remove=function(o){return t.remove(e.users[o]._id,function(t,o){if(null==t&&o.removed===!0)return n("manageAccount.removed").then(function(t){return r.info(t),e.getUsers()})})},e.save=function(){return null!=e.user._id?t.update(e.user,function(t,o){if(null==t&&o.updated===!0)return n("manageAccount.updated").then(function(t){return r.info(t),e.getUsers()})}):t.create(e.user,function(t,o){if(null==t&&o.created===!0)return n("manageAccount.created").then(function(t){return r.info(t),e.getUsers()})})},e.getUsers()}]),r.controller("kraken.navigation",["$scope","$user","$window","$mdSidenav","$menu","$bookmarks","$translate","$logger","$mdDialog",function(e,t,n,r,o,u,i,s,a){e.menu=[],e.bookmarks=[],e.shares=[],e.openSidenav=function(){return r("left").toggle()},e.exit=function(){return t.logout(function(e,t){if(null==e&&null!=t.redirect)return n.location.assign(t.redirect)})},e.removeBookmark=function(t){return u.remove(t,function(t,n){if(null==t&&n.removed)return i("navigation.removeBookmark").then(function(t){return s.info(t),e.getBookmarks()})})},e.getBookmarks=function(){return u.getAll(function(t,n){if(null==t)return e.bookmarks=n})},e.getBookmarks(),o.getItems(function(t,n){if(null==t)return e.menu=n})}]),r.filter("bytes",[function(){return function(e,t){var n,r;return null==t&&(t=1),null!=e&&(0!==e?(r=["o","Ko","Mo","Go","To","Po"],n=Math.floor(Math.log(e)/Math.log(1024)),e=(e/Math.pow(1024,Math.floor(n))).toFixed(t)+" "+r[n]):e="0 o"),e}}]),r.filter("lower",[function(){return function(e){return null!=e&&(e=e.toLowerCase()),e}}]),r.filter("time",[function(){return function(e){var t,n,r;return r="",null!=e&&(t=e/3600,e%=3600,0!==parseInt(t)&&(r+=parseInt(t)+":"),n=e/60,e%=60,r+=parseInt(n)+":"+parseInt(e)),r}}]),r.filter("truncate",[function(){return function(e,t){return null==t&&(t=40),null!=e&&t<e.length&&(e=e.substring(0,t-3)+"..."),e}}]),r.filter("ucfirst",[function(){return function(e){return null!=e&&(e=""+e.charAt(0).toUpperCase()+e.substring(1)),e}}]),r.filter("upper",[function(){return function(e){return null!=e&&(e=e.toUpperCase()),e}}]),r.run(["$rootScope","$location","$user","$translate","$logger",function(e,t,n,r,o){var u;u=["/manage-account"],e.$on("$routeChangeStart",function(){if(-1!==u.indexOf(t.path()))return n.isAdministrator(function(e,n){if(null==e&&!n.administrator)return r("request.notAuthorized").then(function(e){return o.error(e),t.path("/fs")})})})}]),r.service("$audio",["$window","$mdBottomSheet","$fs","$logger",function(e,t,n,r){var o,u,i,s,a;u=["mp3","wav"],s=[],a=0,o=e.document.createElement("audio"),i=!1,o.addEventListener("canplay",function(){return o.play()}),o.addEventListener("ended",function(e){return function(){if(a+1<s.length)return e.next()}}(this)),this.isPlayable=function(e){var t,n,r;for(n=0,r=u.length;n<r;n++)if(t=u[n],new RegExp("(."+t+")$").test(e))return!0;return!1},this.open=function(n){return function(r,u){return t.show({parent:angular.element(e.document.querySelector("body")),clickOutsideToClose:!1,disableBackdrop:!0,disableParentScroll:!1,escapeToClose:!1,templateUrl:"views/audio.jade",controller:["$scope","$mdBottomSheet","$interval",function(e,t,r){e.playing=!0,o.addEventListener("loadstart",function(){return e.endTime=o.duration,e.duration=o.currentTime}),o.addEventListener("loadedmetadata",function(){return e.endTime=o.seekable.end(0)}),e.next=n.next,e.previous=n.previous,e.play=function(){return o.play(),e.playing=!0},e.pause=function(){return o.pause(),e.playing=!1},e.mute=function(){return o.volume=e.volume=0},e.loop=!1,e.setLoop=function(t){return o.loop=e.loop=t},e.stop=function(){return t.hide(),o.pause(),i=!1,s=[],a=0,e.playing=!1},e.volume=100*o.volume,e.changeVolume=function(){return o.volume=e.volume/100},e.duration=o.currentTime,e.changeDuration=function(){return o.currentTime=e.duration},r(function(){return e.duration=o.currentTime},1e3)}]})}}(this),this.play=function(e){return function(t,u){return i||(e.open(t,u),i=!0),r.info(u),o.src=n.realpath("mount/"+t+"/"+u),o.load()}}(this),this.playQueue=function(e){return function(){if(s.length)return e.play(s[0].path,s[0].name)}}(this),this.previous=function(e){return function(){var t;if(!(a-1<0))return t=s[a--],e.play(t.path,t.name)}}(this),this.next=function(e){return function(){var t;if(!(a+1>=s.length))return t=s[a++],e.play(t.path,t.name)}}(this),this.queue=function(e,t){return s.push({path:e,name:t})}}]),r.service("$bookmarks",["$request",function(e){this.get=function(t,n){return e.get("bookmarks/"+t,n)},this.getAll=function(t){return e.get("bookmarks",t)},this.create=function(t,n){return e.post("bookmarks",{path:t},n)},this.update=function(t,n,r){return e.put("bookmarks/"+t,{path:n},r)},this.remove=function(t,n){return e["delete"]("bookmarks/"+t,n)},this.removeAll=function(t){return e["delete"]("bookmarks",t)}}]),r.service("$compress",["$request","$fs",function(e,t){this.zip=function(n,r){return e.post(t.realpath("/compress/"+n),{},r)},this.unzip=function(n,r){return e["delete"](t.realpath("/compress/"+n),r)}}]),r.service("$fs",["$request",function(e){this.slach=function(e){for(;;){if(!/\/\//gi.test(e))return e;e=e.replace(/\/\//gi,"/")}},this.realpath=function(e){return function(t){var n,r,o,u;t=e.slach(t),r=t.split("/"),o=[];for(u in r)n=r[u],parseInt(u)+1<r.length&&".."===r[parseInt(u)+1]||".."!==n&&o.push(n);return 0===o.length?"/":1===o.length?o.join("/").substring(1):o.join("/")}}(this),this.list=function(t){return function(n,r){return e.get(t.slach("/fs/"+t.realpath(n)),r)}}(this),this.remove=function(t){return function(n,r){return e["delete"](t.slach("/fs/"+t.realpath(n)),r)}}(this),this.rename=function(t){return function(n,r,o){return e.patch(t.slach("/fs/"+t.realpath(n)),{path:t.slach(t.realpath(r))},o)}}(this)}]),r.service("$logger",["$mdToast",function(e){this.info=function(t){var n;return n=e.simple(),n.textContent(t).position("bottom right"),e.show(n)},this.warn=function(t){var n;return n=e.simple(),n.textContent(t).position("bottom right"),e.show(n)},this.error=function(t){var n;return n=e.simple(),n.textContent(t).position("bottom right"),e.show(n)}}]),r.service("$menu",["$request",function(e){this.getItems=function(t){return e.get("menu",t)}}]),r.service("$request",["$http","$logger","$translate",function(e,t,n){var r;r=function(e,r){return 403===e.status||401===e.status?n("request.notAuthorized").then(function(e){return t.error(e),r(new Error(e))}):404===e.status?n("request.notFound").then(function(e){return t.error(e),r(new Error(e))}):n("request.failure").then(function(e){return t.error(e),r(new Error(e))})},this.get=function(t,n){return e.get(t).then(function(e){return n(null,e.data)},function(e){return r(e,n)})},this.post=function(t,n,o){return e.post(t,n).then(function(e){return o(null,e.data)},function(e){return r(e,o)})},this.put=function(t,n,o){return e.put(t,n).then(function(e){return o(null,e.data)},function(e){return r(e,o)})},this.patch=function(t,n,o){return e.patch(t,n).then(function(e){return o(null,e.data)},function(e){return r(e,o)})},this["delete"]=function(t,n){return e["delete"](t).then(function(e){return n(null,e.data)},function(e){return r(e,n)})}}]),r.service("$signets",["$request","$fs",function(e,t){this.get=function(t){return e.get("/signets",t)},this.getOne=function(t,n){return e.get("/signets/"+t,n)},this.create=function(n,r){return e.post("/signets",{path:t.realpath(n)},r)},this.update=function(n,r,o){return e.put("/signets/"+n,{path:t.realpath(r)},o)},this["delete"]=function(t,n){return e["delete"]("/signets/"+t,n)}}]),r.service("$user",["$request",function(e){this.get=function(t,n){return e.get("users/"+t,n)},this.update=function(t,n){return e.put("users/"+t._id,t,n)},this.remove=function(t,n){return e["delete"]("users/"+t,n)},this.create=function(t,n){return e.post("users",t,n)},this.getAll=function(t){return e.get("users",t)},this.isLog=function(t){return e.get("log",t)},this.login=function(t,n,r){return e.post("log",{username:t,password:n},r)},this.logout=function(t){return e["delete"]("log",t)},this.isAdministrator=function(t){return e.get("administrator",t)}}]),r.service("$video",["$window","$mdDialog","$logger","$translate",function(e,t,n,r){var o;o=[{extension:"mp4",mime:"video/mp4"},{extension:"webm",mime:"video/webm"},{extension:"ogg",mime:"application/ogg"}],this.isPlayable=function(e){var t,n,r;for(t=0,n=o.length;t<n;t++)if(r=o[t],new RegExp("(."+r.extension+")$","i").test(e))return!0;return!1},this.mime=function(e){var t,n,r;for(t=0,n=o.length;t<n;t++)if(r=o[t],new RegExp("(."+r.extension+")$","i").test(e))return r.mime;return null},this.extension=function(e){var t,n,r;for(t=0,n=o.length;t<n;t++)if(r=o[t],new RegExp("(."+r.extension+")$","i").test(e))return r.extension;return null},this.play=function(o){return function(u,i,s){return o.isPlayable(i)?t.show({parent:angular.element(e.document.querySelector("body")),targetEvent:s,clickOutsideToClose:!0,templateUrl:"views/video.jade",controller:["$scope","$mdDialog","$fs",function(e,t,n){e.name=n.realpath("mount/"+u+"/"+i),e.mime=o.mime(i),e.basename=i,e.close=function(){return t.hide()}}]}):r("service.$video.error").then(function(e){return n.error(e)})}}(this)}])},function(e,t,n){function r(e){return n(o(e))}function o(e){return u[e]||function(){throw new Error("Cannot find module '"+e+"'.")}()}var u={"./en.lang.json":3};r.keys=function(){return Object.keys(u)},r.resolve=o,e.exports=r,r.id=2},function(e,t){e.exports={app:{name:"Kraken"},toolbar:{exit:"Exit"},navigation:{fs:"File system",manageAccount:"Manage account",menu:"Menu",removeBookmark:"Successfuly removed bookmark",removeShare:"Successfuly removed sharing",bookmark:{singular:"Bookmark",plural:"Bookmarks"},share:{singular:"Share",plural:"Shares"}},request:{failure:"Request failure",notAuthorized:"Your are not authorized to perform this action",notFound:"Request document is not found"},login:{send:"Sign in",username:"Username",password:"Password",success:"Successfuly connected",wrong:"Wrong password or username",error:{required:"This field is required"}},manageAccount:{username:"User name",password:"Password",firstname:"First name",lastname:"Last name",email:"Mail",administrator:"His an administrator ?",submit:"Save",remove:"Remove",userInformation:"User information",userInformationComplete:"Complete information about user",selectUser:"Select user to modify",addAdministrator:"Create a new user",removed:"Successfuly removed an user",updated:"Successfuly updated an user",created:"Successfuly created an user",error:{required:"This is required.",email:"This is not a correct email."}},fs:{remove:"Successfuly removed",renameDialog:{title:"Rename",text:"Rename a file or folder",placeholder:"New name",ok:"Ok",cancel:"Cancel",success:"Successfuly renamed"},table:{name:"Name",size:"Size",mtime:"Last modified"},options:{bookmarks:"Bookmarks",open:"Open",share:"Share",rename:"Rename",download:"Download",archive:"Compress",unarchive:"Uncompress","delete":"Delete",play:"Play",queue:"Queue"},fab:{menu:"Menu",refresh:"Refresh",root:"Go to root",share:"Shared file or folder",queue:"Play songs of queue"},toolbar:{filter:"",list:"List",item:{singular:"item selected",plural:"items selecteds"}},bookmark:{success:"Successfuly bookmarks"},compress:{success:"Successfuly compressed"},uncompress:{success:"Successfuly uncompressed"}},service:{$audio:{error:"This is not a supported audio format",play:"Play",pause:"Pause",stop:"Stop",loop:"Loop",previous:"Previous",next:"Next",mute:"Mute",duration:"Duration",volume:"Volume"},$video:{error:"This is not a supported movie format"}}}}]);